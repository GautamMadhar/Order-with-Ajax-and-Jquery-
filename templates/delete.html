<html>
    <head>
        <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">-->

        <title>
            Order Page
         </title>   
    </head>
    <body>
<table border = '2' id = 'data_table'>
                <tr align="center">
                    <td>
                        Name     
                    </td>
                    <td>
                        Address
                    </td>
                    <td>
                        Email
                    </td>
                </tr>
                {% for data in order_data %}
                <tr id='record'>
                    <td>
                        {{data.firstname}} &nbsp; {{data.lastname}}    
                    </td>
                    <td>
                        {{data.address_street}} &nbsp;
                        {{data.address_landmark}} &nbsp;
                        {{data.address_pincode}}
                    </td>
                    <td>
                        {{data.email}}
                    </td>
                    <td>
                        <button type="submit">update</button>
                       <a href = '{% url "delete" data.id %}' id = 'del_task'>  delete</a>
                        
                    </td>

                </tr>
                {% endfor %}
        </table>


</body>
    <script src="/static/js/jquery-2.2.4.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script>
        $(document).on('submit', '#insert',function(e){
            e.preventDefault();
            $.ajax({
                type:'POST',
                url:'{% url "insert" %}',
                data:{
                    firstname:$('#firstname').val(),
                    lastname:$('#lastname').val(),
                    email:$('#email').val(),
                    street:$('#street').val(),
                    landmark:$('#landmark').val(),
                    postalcode:$('#postalcode').val(),

                    csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                    action: 'post'
                },
                
                success:function(json){
                    document.getElementById("insert").reset();
                    alert("Data Uploaded Successfully");
                }
            });
        });


        $("#del_task").on("click", function(e){
            e.preventDefault();
            var $this = $(this);
            if(confirm("Sure Want to delete ?? ")){
                $.ajax({
                    url:$this.attr("href"),
                    type :"GET",
                    dataType= "json",
                    success: function(resp){
                        if(resp.message == "success"){
                            $this.parents('#record').fadeOut("slow",function(){
                                $this.parents('#record')
                            });
                        }
                        else{
                            alert(resp.message);
                        }

                    }
                        
                });
            }
            return false;
           }
    </script>

    </html>